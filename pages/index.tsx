import React, { useEffect, useRef } from "react";
import Head from "next/head";
import Image from "next/image";
import styles from "../styles/Home.module.css";
import Web3Modal from "web3modal";
import WalletConnectProvider from "@walletconnect/web3-provider";
import Grid from "@mui/material/Grid";
import { theme } from "../styles/Theme";
import Typography from "@mui/material/Typography";
import Button from "@mui/material/Button";
import LoadingButton from "@mui/lab/LoadingButton";
import { useRouter } from "next/router";
import { useWeb3 } from "../hooks/Web3Contaxt";
import Logo from "../icons/image.svg";
import MetaIcon from "../icons/metamask-fox.png";
import Typewriter from "typewriter-effect";
import CanvasBackground from "../components/CanvasBackground";
import Footer from "../components/Footer";
import CircularProgress from "@mui/material/CircularProgress";

const Home = ({ timeout = 50 }) => {
  const { connectWallet, connected } = useWeb3();
  const router = useRouter();
  const [loading, setLoading] = React.useState(false);

  useEffect(() => {
    if (connected == true) {
      router.push("/dashboard");
    }
  }, [!connected]);

  return (
    <div
      className={styles.container}
      style={{
        backgroundColor: "transparent",
      }}
    >
      <Head>
        <title>Fountain Farm</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>
        <CanvasBackground />
        <Grid
          container
          pt={15}
          style={{
            display: "flex",
            flexDirection: "column",
            justifyContent: "center",
            alignItems: "center",
            width: "100vw",
          }}
        >
          <Image src={Logo} alt="SVG logo image" width={460} height={250} />
          <div className={styles.title}>
            <Typewriter
              options={{
                strings: [
                  "Hey you...",
                  "Welcome to Fountain Finance",
                  "A Goli farming platform",
                  "Connect your MetaMask to start",
                ],
                autoStart: true,
                loop: true,
              }}
            />
          </div>
        </Grid>

        <Grid
          container
          pt={10}
          spacing={2}
          style={{
            display: "flex",
            justifyContent: "center",
            alignItems: "center",
          }}
        >
          <Grid item>
            <LoadingButton
              variant="contained"
              color="primary"
              onClick={() => {
                connectWallet();
                setLoading(true);
              }}
              endIcon={
                <Image
                  src={MetaIcon}
                  alt="SVG logo image"
                  width={30}
                  height={30}
                />
              }
              loading={loading}
              loadingPosition="end"
              loadingIndicator={<CircularProgress color="success" />}
            >
              CONNECT MetaMask
            </LoadingButton>
          </Grid>
          <Footer />
        </Grid>
      </main>
    </div>
  );
};
export default Home;
